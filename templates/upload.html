<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dosya Yükle - Malware Analysis Platform</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/style.css') }}" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">
                <i class="fas fa-shield-virus me-2"></i>
                Malware Analysis Platform
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/">Ana Sayfa</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="/upload">Dosya Yükle</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <!-- Page Header -->
                <div class="text-center mb-5">
                    <h1 class="fw-bold">
                        <i class="fas fa-upload me-3"></i>
                        Malware Dosyası Yükle
                    </h1>
                    <p class="text-muted">
                        Analiz edilecek malware dosyasını seçin ve güvenli analiz sürecini başlatın
                    </p>
                </div>

                <!-- Upload Form -->
                <div class="card shadow">
                    <div class="card-body p-5">
                        <form id="uploadForm" enctype="multipart/form-data">
                            <!-- File Drop Zone -->
                            <div id="dropZone" class="drop-zone border border-2 border-dashed rounded p-5 text-center mb-4">
                                <div class="drop-zone-content">
                                    <i class="fas fa-cloud-upload-alt fa-4x text-muted mb-3"></i>
                                    <h5 class="mb-3">Dosyayı buraya sürükleyin veya tıklayın</h5>
                                    <p class="text-muted mb-3">
                                        Desteklenen formatlar: Executables, Scripts, Archives, Documents, Mobile Apps, Email Files
                                    </p>
                                    <input type="file" id="fileInput" name="file" class="d-none" accept="*/*">
                                    <button type="button" class="btn btn-primary" onclick="document.getElementById('fileInput').click()">
                                        <i class="fas fa-folder-open me-2"></i>
                                        Dosya Seç
                                    </button>
                                </div>
                            </div>

                            <!-- File Info -->
                            <div id="fileInfo" class="alert alert-info d-none">
                                <div class="d-flex align-items-center">
                                    <i class="fas fa-file me-3"></i>
                                    <div>
                                        <strong id="fileName"></strong><br>
                                        <small id="fileSize" class="text-muted"></small>
                                    </div>
                                    <button type="button" class="btn btn-sm btn-outline-danger ms-auto" onclick="clearFile()">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                            </div>

                            <!-- Analysis Options -->
                            <div class="mb-4">
                                <h6 class="mb-3">
                                    <i class="fas fa-cogs me-2"></i>
                                    Analiz Seçenekleri
                                </h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="enableVirusTotal" name="enable_virustotal" checked>
                                    <label class="form-check-label" for="enableVirusTotal">
                                        <strong>VirusTotal Analizi Aktif Et</strong>
                                        <br>
                                        <small class="text-muted">
                                            Dosyayı VirusTotal üzerinden de tarayarak daha kapsamlı analiz sağlar (Önerilen)
                                        </small>
                                    </label>
                                </div>
                                <div class="mt-2">
                                    <small class="text-success">
                                        <i class="fas fa-check-circle me-1"></i>
                                        VirusTotal API anahtarı yapılandırılmış - Analiz kullanıma hazır
                                    </small>
                                </div>
                                <div class="mt-1">
                                    <small class="text-info">
                                        <i class="fas fa-info-circle me-1"></i>
                                        API anahtarı yapılandırılmamışsa bu seçenek mevcut analiz verilerini kullanır
                                    </small>
                                </div>
                            </div>

                            <!-- Upload Button -->
                            <div class="text-center">
                                <button type="submit" id="uploadBtn" class="btn btn-success btn-lg px-5" disabled>
                                    <i class="fas fa-upload me-2"></i>
                                    Analizi Başlat
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Progress Section -->
                <div id="progressSection" class="card shadow mt-4 d-none">
                    <div class="card-body">
                        <h5 class="card-title">
                            <i class="fas fa-cogs me-2"></i>
                            Analiz İlerlemesi
                        </h5>
                        
                        <!-- Progress Bar -->
                        <div class="progress mb-3" style="height: 20px;">
                            <div id="progressBar" class="progress-bar progress-bar-striped progress-bar-animated" 
                                 role="progressbar" style="width: 0%" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
                                0%
                            </div>
                        </div>
                        
                        <!-- Current Stage -->
                        <div id="currentStage" class="text-center text-muted">
                            Analiz başlatılıyor...
                        </div>
                        
                        <!-- Cancel Button -->
                        <div class="text-center mt-3">
                            <button id="cancelBtn" class="btn btn-outline-danger" onclick="cancelAnalysis()">
                                <i class="fas fa-stop me-2"></i>
                                İptal Et
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Results Section -->
                <div id="resultsSection" class="card shadow mt-4 d-none">
                    <div class="card-body text-center">
                        <div id="successResult" class="d-none">
                            <i class="fas fa-check-circle fa-4x text-success mb-3"></i>
                            <h4 class="text-success">Analiz Tamamlandı!</h4>
                            <p class="text-muted mb-4">Malware analizi başarıyla tamamlandı. Detaylı raporu görüntüleyebilirsiniz.</p>
                            <a id="reportLink" href="#" class="btn btn-primary btn-lg">
                                <i class="fas fa-file-alt me-2"></i>
                                Raporu Görüntüle
                            </a>
                        </div>
                        
                        <div id="errorResult" class="d-none">
                            <i class="fas fa-exclamation-triangle fa-4x text-danger mb-3"></i>
                            <h4 class="text-danger">Analiz Hatası!</h4>
                            <p id="errorMessage" class="text-muted mb-4"></p>
                            <button class="btn btn-secondary" onclick="resetForm()">
                                <i class="fas fa-redo me-2"></i>
                                Yeniden Dene
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Security Warning -->
                <div class="alert alert-warning mt-4">
                    <div class="d-flex align-items-center">
                        <i class="fas fa-shield-alt fa-2x me-3"></i>
                        <div>
                            <h6 class="fw-bold mb-1">Güvenlik Bilgilendirmesi</h6>
                            <small>
                                Yüklenen dosyalar izole edilmiş sandbox ortamında analiz edilir. 
                                Maksimum dosya boyutu 100MB'tır. Sadece malware analizi amaçlı dosyalar yükleyin.
                            </small>
                        </div>
                    </div>
                </div>

                <!-- Supported Formats -->
                <div class="card mt-4">
                    <div class="card-header">
                        <h6 class="mb-0">
                            <i class="fas fa-list me-2"></i>
                            Desteklenen Dosya Formatları 
                        </h6>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="mb-4">
                                    <h6 class="text-primary">
                                        <i class="fab fa-windows me-2"></i>
                                        Windows Executables (.exe, .dll, .msi, .bin)
                                    </h6>
                                    <span class="badge bg-success me-2">Static</span>
                                    <p class="small text-muted mt-2">PE dosyaları, DLL'ler, MSI paketleri ve binary dosyalar</p>
                                </div>

                                <div class="mb-4">
                                    <h6 class="text-warning">
                                        <i class="fab fa-linux me-2"></i>
                                        Linux Executables (.elf, .bin)
                                    </h6>
                                    <span class="badge bg-success me-2">Static</span>
                                    <p class="small text-muted mt-2">ELF formatındaki Linux executable dosyaları</p>
                                </div>

                                <div class="mb-4">
                                    <h6 class="text-secondary">
                                        <i class="fab fa-apple me-2"></i>
                                        MacOS Executables (mach-o)
                                    </h6>
                                    <span class="badge bg-success">Static</span>
                                    <p class="small text-muted mt-2">macOS Mach-O formatındaki executable dosyalar</p>
                                </div>

                                <div class="mb-4">
                                    <h6 class="text-success">
                                        <i class="fab fa-android me-2"></i>
                                        Android Files (.apk, .jar, .dex)
                                    </h6>
                                    <span class="badge bg-success me-2">Static</span>
                                    <p class="small text-muted mt-2">Android uygulamaları ve Java archive dosyaları</p>
                                </div>

                                <div class="mb-4">
                                    <h6 class="text-info">
                                        <i class="fas fa-code me-2"></i>
                                        Golang Binaries (Linux)
                                    </h6>
                                    <span class="badge bg-success">Static</span>
                                    <p class="small text-muted mt-2">Go dili ile geliştirilmiş Linux binary dosyaları</p>
                                </div>
                            </div>
                            
                            <div class="col-md-6">
                                <div class="mb-4">
                                    <h6 class="text-primary">
                                        <i class="fas fa-file-alt me-2"></i>
                                        Document Files
                                    </h6>
                                    <span class="badge bg-success">Static</span>
                                    <p class="small text-muted mt-2">Office dokümanları, PDF'ler (.doc, .docx, .xls, .pdf vb.)</p>
                                </div>

                                <div class="mb-4">
                                    <h6 class="text-dark">
                                        <i class="fas fa-archive me-2"></i>
                                        Archive Files (.zip, .rar, .ace)
                                    </h6>
                                    <span class="badge bg-success">Static</span>
                                    <p class="small text-muted mt-2">Sıkıştırılmış arşiv dosyaları</p>
                                </div>

                                <div class="mb-4">
                                    <h6 class="text-secondary">
                                        <i class="fas fa-network-wired me-2"></i>
                                        PCAP Files (.pcap)
                                    </h6>
                                    <span class="badge bg-success">Static</span>
                                    <p class="small text-muted mt-2">Ağ trafiği yakalama dosyaları</p>
                                </div>

                                <div class="mb-4">
                                    <h6 class="text-primary">
                                        <i class="fas fa-terminal me-2"></i>
                                        PowerShell Scripts
                                    </h6>
                                    <span class="badge bg-success">Static</span>
                                    <p class="small text-muted mt-2">PowerShell script dosyaları (.ps1, .psm1, .psd1)</p>
                                </div>

                                <div class="mb-4">
                                    <h6 class="text-warning">
                                        <i class="fas fa-envelope me-2"></i>
                                        E-Mail Files (.eml)
                                    </h6>
                                    <span class="badge bg-success">Static</span>
                                    <p class="small text-muted mt-2">E-posta dosyaları ve ekleri</p>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4 p-3 bg-light rounded">
                            <h6 class="text-muted mb-3">
                                <i class="fas fa-info-circle me-2"></i>
                                Analiz Türleri Açıklaması
                            </h6>
                            <div class="row">
                                <div class="col-md-6">
                                    <div class="d-flex align-items-center mb-2">
                                        <span class="badge bg-success me-2">Static</span>
                                        <span class="small">Dosya içeriği analizi, imza taraması, metadata çıkarımı</span>
                                    </div>
                                </div>
                               
                            </div>
                        </div>

                        <div class="mt-3">
                            <small class="text-info">
                                <i class="fas fa-shield-alt me-1"></i>
                                <strong>Güvenlik:</strong> Uzantısız dosyalar da kabul edilir. Tüm analizler izole sandbox ortamında gerçekleştirilir.
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="{{ url_for('static', filename='js/upload.js') }}"></script>
</body>
</html>
